var jsPsychImageKeyboardResponse=function(r){"use strict";var y="2.1.0";const _={name:"image-keyboard-response",version:y,parameters:{stimulus:{type:r.ParameterType.IMAGE,default:void 0},stimulus_height:{type:r.ParameterType.INT,default:null},stimulus_width:{type:r.ParameterType.INT,default:null},maintain_aspect_ratio:{type:r.ParameterType.BOOL,default:!0},choices:{type:r.ParameterType.KEYS,default:"ALL_KEYS"},prompt:{type:r.ParameterType.HTML_STRING,default:null},stimulus_duration:{type:r.ParameterType.INT,default:null},trial_duration:{type:r.ParameterType.INT,default:null},response_ends_trial:{type:r.ParameterType.BOOL,default:!0},render_on_canvas:{type:r.ParameterType.BOOL,default:!0}},data:{stimulus:{type:r.ParameterType.STRING},response:{type:r.ParameterType.STRING},rt:{type:r.ParameterType.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class m{constructor(e){this.jsPsych=e}trial(e,t){var s,i;if(t.render_on_canvas){var u=!1;if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild);var l=document.createElement("canvas");l.id="jspsych-image-keyboard-response-stimulus",l.style.margin="0",l.style.padding="0";var h=l.getContext("2d"),a=new Image;a.onload=()=>{u||(n(),h.drawImage(a,0,0,i,s))},a.src=t.stimulus;const n=()=>{t.stimulus_height!==null?(s=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(i=a.naturalWidth*(t.stimulus_height/a.naturalHeight))):s=a.naturalHeight,t.stimulus_width!==null?(i=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(s=a.naturalHeight*(t.stimulus_width/a.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(i=a.naturalWidth),l.height=s,l.width=i};n(),e.insertBefore(l,null),a.complete&&Number.isFinite(i)&&Number.isFinite(s)&&(h.drawImage(a,0,0,i,s),u=!0),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt)}else{var d='<img src="'+t.stimulus+'" id="jspsych-image-keyboard-response-stimulus">';t.prompt!==null&&(d+=t.prompt),e.innerHTML=d;var a=e.querySelector("#jspsych-image-keyboard-response-stimulus");t.stimulus_height!==null?(s=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(i=a.naturalWidth*(t.stimulus_height/a.naturalHeight))):s=a.naturalHeight,t.stimulus_width!==null?(i=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(s=a.naturalHeight*(t.stimulus_width/a.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(i=a.naturalWidth),a.style.height=s.toString()+"px",a.style.width=i.toString()+"px"}var o={rt:null,key:null};const p=()=>{typeof c!="undefined"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(c);var n={rt:o.rt,stimulus:t.stimulus,response:o.key};this.jsPsych.finishTrial(n)};var g=n=>{e.querySelector("#jspsych-image-keyboard-response-stimulus").className+=" responded",o.key==null&&(o=n),t.response_ends_trial&&p()};if(t.choices!="NO_KEYS")var c=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:g,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1});t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-image-keyboard-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null?this.jsPsych.pluginAPI.setTimeout(()=>{p()},t.trial_duration):t.response_ends_trial===!1&&console.warn("The experiment may be deadlocked. Try setting a trial duration or set response_ends_trial to true.")}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),u=this.jsPsych.getDisplayElement();this.trial(u,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(e.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}}return m.info=_,m}(jsPsychModule);
//# sourceMappingURL=https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.1.0/dist/index.browser.min.js.map
